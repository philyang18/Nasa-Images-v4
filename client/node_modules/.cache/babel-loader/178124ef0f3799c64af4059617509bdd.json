{"ast":null,"code":"var _jsxFileName = \"/Users/phillipyang/Desktop/Nasa-Images-v4/client/src/SingleMarsImage.js\";\nimport React from \"react\";\nimport { fetchRover, fetchMarsFavorites, BACK_SERVER_URL } from \"./NasaAPIs\";\nimport { NavLink } from \"react-router-dom\";\nimport ErrorPage from \"./ErrorPage\";\nimport Loading from \"./Loading\";\nimport { formatDisplayDate } from \"./Formatting\";\nimport DocumentTitle from \"react-document-title\";\nimport { addPhotoNotification, removePhotoNotification } from \"./Notifications\";\nimport axios from 'axios';\nconst API = \"https://itp404-final-project-yangphil.herokuapp.com/api/favorites\";\nexport default class SingleMarsImage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      console.log(this.props);\n      this.setState({\n        loading: true\n      });\n\n      try {\n        // date and photo id are passed in via url they need to be extracted\n        var firstSplit = this.props.match.params.info.split(\"=\");\n        const id = firstSplit[2]; // extract the id\n\n        var secondSplit = firstSplit[1].split(\"&\");\n        const earthDate = secondSplit[0]; // after extracting the date, I can use it to grab the JSON for that date\n\n        const photos = await fetchRover(earthDate);\n        this.setState({\n          photos\n        });\n        this.state.photos.map(photo => {\n          // check if that ID exists incase the user plays w/ the url\n          if (String(photo.id) === id) {\n            this.setState({\n              idExists: true,\n              photo\n            });\n            this.checkIfLiked();\n          }\n\n          return 0;\n        });\n      } catch {\n        // this.setState({ loadingError: true });\n        this.props.history.push({\n          pathname: \"/mars\",\n          state: {\n            email: this.props.location.state.email\n          }\n        });\n      }\n\n      this.setState({\n        loading: false\n      });\n    };\n\n    this.checkIfLiked = async () => {\n      const urlComponents = this.state.photo.img_src.split(\"/\");\n      const id = urlComponents[urlComponents.length - 1];\n      const acc = {\n        _id: this.props.location.state.email,\n        data: {\n          _id: id\n        }\n      };\n      let res = await axios.post(`${BACK_SERVER_URL}/account/favorites/mars/fetch`, acc);\n      console.log(res);\n\n      if (res.status !== 200) {\n        this.setState({\n          liked: false\n        });\n      } else {\n        this.setState({\n          liked: true\n        });\n      }\n    };\n\n    this.toggleLike = async () => {\n      const urlComponents = this.state.photo.img_src.split(\"/\");\n      const id = urlComponents[urlComponents.length - 1];\n\n      if (!this.state.liked) {\n        const newFav = {\n          _id: this.props.location.state.email,\n          data: {\n            _id: id,\n            url: this.state.photo.img_src,\n            date: this.state.photo.earth_date,\n            comment: \"\",\n            api: \"mars\",\n            array_id: this.state.photo.id\n          }\n        };\n        axios.put(`${BACK_SERVER_URL}/account/favorites/mars/add`, newFav).then(response => {\n          console.log(response);\n        }).catch(err => {\n          console.log(err);\n        });\n        addPhotoNotification(id);\n      } else if (this.state.liked) {\n        axios.delete(`${BACK_SERVER_URL}/account/favorites/mars/delete`, {\n          // for delete, all data must be wrapped in data\n          data: {\n            _id: this.props.location.state.email,\n            data: {\n              _id: id\n            }\n          }\n        }).then(response => {\n          console.log(response);\n        }).catch(err => {\n          console.log(\"didn't delete\");\n        });\n        removePhotoNotification(id);\n      }\n\n      this.setState({\n        liked: !this.state.liked\n      });\n    };\n\n    this.lastTap = null;\n\n    this.handleDoubleTap = () => {\n      const now = Date.now();\n      const DOUBLE_PRESS_DELAY = 300;\n\n      if (this.lastTap && now - this.lastTap < DOUBLE_PRESS_DELAY) {\n        this.toggleLike();\n      } else {\n        this.lastTap = now;\n      }\n    };\n\n    this.state = {\n      photos: [],\n      idExists: false,\n      loading: false,\n      photo: {},\n      liked: false // loadingError: false\n\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(DocumentTitle, {\n      title: \"Mars Image Details\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      id: \"singlePhotoPage\",\n      onClick: this.props.onClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }\n    }, this.state.loading ? /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 13\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    }, this.state.photos.length === 0 || !this.state.idExists ? /*#__PURE__*/React.createElement(ErrorPage, {\n      url: this.props.location.pathname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }\n    }) : /*#__PURE__*/React.createElement(\"div\", {\n      key: this.state.photo.id,\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      to: {\n        pathname: \"/mars\",\n        state: {\n          email: this.props.location.state.email,\n          earth_date: this.state.photo.earth_date\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      id: \"back-button\",\n      className: \"btn col-12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 24\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"icon-circle-arrow-left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 67\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-7 col-md-7 col-sm-12 single-photo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"col-12\",\n      onClick: this.handleDoubleTap,\n      src: this.state.photo.img_src,\n      alt: this.state.photo.camera ? this.state.photo.camera.full_name : \"mars image\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 23\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-5 col-md-5 col-sm-12 single-photo-details\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 23\n      }\n    }, \"Details\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 25\n      }\n    }, \"Date Taken: \"), formatDisplayDate(this.state.photo.earth_date)), this.state.photo.rover ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 27\n      }\n    }, \"Rover: \"), this.state.photo.rover.name) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 32\n      }\n    }), this.state.photo.camera ? /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 27\n      }\n    }, \"Camera: \"), this.state.photo.camera.full_name) : /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 32\n      }\n    }), this.state.photo.rover ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 29\n      }\n    }, \"Launch Date: \"), formatDisplayDate(this.state.photo.rover.launch_date)), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 29\n      }\n    }, \"Landing Date: \"), formatDisplayDate(this.state.photo.rover.landing_date)), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 27\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 29\n      }\n    }, \"Status: \"), this.state.photo.rover.status)) : /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 34\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"icon-holder\",\n      onClick: this.toggleLike,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: this.state.liked ? require(\"./images/filledHeart.png\") : require(\"./images/emptyHeart.png\"),\n      className: \"heart-icon\",\n      alt: \"heart icon\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 25\n      }\n    }))))))));\n  }\n\n}","map":{"version":3,"sources":["/Users/phillipyang/Desktop/Nasa-Images-v4/client/src/SingleMarsImage.js"],"names":["React","fetchRover","fetchMarsFavorites","BACK_SERVER_URL","NavLink","ErrorPage","Loading","formatDisplayDate","DocumentTitle","addPhotoNotification","removePhotoNotification","axios","API","SingleMarsImage","Component","constructor","props","componentDidMount","console","log","setState","loading","firstSplit","match","params","info","split","id","secondSplit","earthDate","photos","state","map","photo","String","idExists","checkIfLiked","history","push","pathname","email","location","urlComponents","img_src","length","acc","_id","data","res","post","status","liked","toggleLike","newFav","url","date","earth_date","comment","api","array_id","put","then","response","catch","err","delete","lastTap","handleDoubleTap","now","Date","DOUBLE_PRESS_DELAY","render","onClick","camera","full_name","rover","name","launch_date","landing_date","require"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { fetchRover, fetchMarsFavorites, BACK_SERVER_URL } from \"./NasaAPIs\";\nimport { NavLink } from \"react-router-dom\";\nimport ErrorPage from \"./ErrorPage\";\nimport Loading from \"./Loading\";\nimport { formatDisplayDate } from \"./Formatting\";\nimport DocumentTitle from \"react-document-title\";\nimport { addPhotoNotification, removePhotoNotification } from \"./Notifications\";\nimport axios from 'axios';\nconst API = \"https://itp404-final-project-yangphil.herokuapp.com/api/favorites\";\n\n\nexport default class SingleMarsImage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      photos: [],\n      idExists: false,\n      loading: false,\n      photo: {},\n      liked: false\n      // loadingError: false\n    };\n  }\n  componentDidMount = async () => {\n    console.log(this.props);\n    this.setState({ loading: true });\n    try {\n      // date and photo id are passed in via url they need to be extracted\n      var firstSplit = this.props.match.params.info.split(\"=\");\n      const id = firstSplit[2]; // extract the id\n      var secondSplit = firstSplit[1].split(\"&\");\n      const earthDate = secondSplit[0];\n      // after extracting the date, I can use it to grab the JSON for that date\n      const photos = await fetchRover(earthDate);\n      this.setState({ photos });\n      this.state.photos.map(photo => {\n        // check if that ID exists incase the user plays w/ the url\n        if (String(photo.id) === id) {\n          this.setState({ idExists: true, photo });\n          this.checkIfLiked();\n        }\n        return 0;\n      });\n    } catch {\n      // this.setState({ loadingError: true });\n      this.props.history.push({\n        pathname: \"/mars\",\n        state: {\n          email: this.props.location.state.email\n        }\n      })\n    }\n    this.setState({ loading: false });\n  };\n  checkIfLiked = async () => {\n\n    const urlComponents = this.state.photo.img_src.split(\"/\");\n    const id = urlComponents[urlComponents.length - 1];\n\t\t\n\t\tconst acc = {\n\t\t\t_id: this.props.location.state.email,\n\t\t\tdata: {\n\t\t\t\t_id: id\n\t\t\t}\n\t\t}\n\t\tlet res = await axios.post(`${BACK_SERVER_URL}/account/favorites/mars/fetch`, acc);\n\t\tconsole.log(res);\n\t\tif(res.status !== 200) {\n\t\t\tthis.setState({ liked: false });\n\t\t} else {\n\t\t\tthis.setState({ liked: true });\n\t\t}\n    \n  };\n  toggleLike = async () => {\n    const urlComponents = this.state.photo.img_src.split(\"/\");\n    const id = urlComponents[urlComponents.length - 1];\n    if(!this.state.liked){\n\t\t\tconst newFav = {\n        _id: this.props.location.state.email,\n        data: {\n\t\t\t\t\t_id: id,\n\t\t\t\t\turl: this.state.photo.img_src,\n\t\t\t\t\tdate: this.state.photo.earth_date,\n\t\t\t\t\tcomment: \"\",\n          api: \"mars\",\n          array_id: this.state.photo.id\n\t\t\t\t}\n\t\t\t};\n\t\t\taxios.put(`${BACK_SERVER_URL}/account/favorites/mars/add`, newFav)\n\t\t\t\t.then(response => {\n\t\t\t\t\tconsole.log(response);\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tconsole.log(err);\n\t\t\t\t});\n\t\t\taddPhotoNotification(id);\n\t\t}\n\t\telse if(this.state.liked){\n\t\t\taxios.delete(`${BACK_SERVER_URL}/account/favorites/mars/delete`, {\n\t\t\t\t// for delete, all data must be wrapped in data\n        data: {\n\t\t\t\t\t_id: this.props.location.state.email,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t_id: id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(response => {\n\t\t\t\tconsole.log(response);\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.log(\"didn't delete\");\n\t\t\t});\n\t\t\tremovePhotoNotification(id);\n\t\t}\n\t\tthis.setState({ liked: !this.state.liked });\n\n  };\n  lastTap = null;\n  handleDoubleTap = () => {\n    const now = Date.now();\n    const DOUBLE_PRESS_DELAY = 300;\n    if (this.lastTap && now - this.lastTap < DOUBLE_PRESS_DELAY) {\n      this.toggleLike();\n    } else {\n      this.lastTap = now;\n    }\n  };\n  render() {\n    return (\n      <DocumentTitle title=\"Mars Image Details\">\n        <div id=\"singlePhotoPage\"  onClick={this.props.onClick}>\n          {this.state.loading ? (\n            <Loading />\n          ) : (\n            <div>\n              {this.state.photos.length === 0 || !this.state.idExists ? (\n                <ErrorPage url={this.props.location.pathname} />\n              ) : (\n                <div key={this.state.photo.id} className=\"container\">\n                  <div className=\"row\">\n                    <NavLink\n                      to={{\n                        pathname: \"/mars\",\n                        state: {\n                          email: this.props.location.state.email,\n                          earth_date: this.state.photo.earth_date\n                        }\n                      }}\n                    >\n                       <a id=\"back-button\" className=\"btn col-12\"><i className=\"icon-circle-arrow-left\"></i></a>\n                    </NavLink>\n                  </div>\n                  <div className=\"row\">\n                    <div className=\"col-lg-7 col-md-7 col-sm-12 single-photo\">\n                      <img\n                        className=\"col-12\"\n                        onClick={this.handleDoubleTap}\n                        src={this.state.photo.img_src}\n                        alt={this.state.photo.camera ? this.state.photo.camera.full_name : \"mars image\"}\n                      />\n                    </div>\n                    <div className=\"col-lg-5 col-md-5 col-sm-12 single-photo-details\">\n                      <h2>Details</h2>\n                      <p>\n                        <strong>Date Taken: </strong>\n                        {formatDisplayDate(this.state.photo.earth_date)}\n                      </p>\n                      {this.state.photo.rover ? \n                        <p>\n                          <strong>Rover: </strong>\n                          {this.state.photo.rover.name }\n                        </p> : <p/> \n                      }\n                      {this.state.photo.camera ?\n                        <p>\n                          <strong>Camera: </strong>\n                          {this.state.photo.camera.full_name}\n                        </p> : <p/>\n                      }\n                      {this.state.photo.rover ? \n                        <div>\n                          <p>\n                            <strong>Launch Date: </strong>\n                            {formatDisplayDate(this.state.photo.rover.launch_date)}\n                          </p> \n                          <p>\n                            <strong>Landing Date: </strong>\n                            {formatDisplayDate(this.state.photo.rover.landing_date)}\n                          </p>\n                          <p>\n                            <strong>Status: </strong>\n                            {this.state.photo.rover.status}\n                          </p>\n                        </div> : <div/>\n                      }\n                      <p className=\"icon-holder\" onClick={this.toggleLike}>\n                        <img\n                          src={\n                            this.state.liked\n                              ? require(\"./images/filledHeart.png\")\n                              : require(\"./images/emptyHeart.png\")\n                          }\n                          className=\"heart-icon\"\n                          alt=\"heart icon\"\n                        />\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </DocumentTitle>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}