{"ast":null,"code":"import _regeneratorRuntime from\"/Users/phillipyang/Desktop/Nasa-Images-v3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/phillipyang/Desktop/Nasa-Images-v3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/phillipyang/Desktop/Nasa-Images-v3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/phillipyang/Desktop/Nasa-Images-v3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/phillipyang/Desktop/Nasa-Images-v3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/phillipyang/Desktop/Nasa-Images-v3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import DatePicker from\"react-datepicker\";import{NavLink}from\"react-router-dom\";import{fetchRover}from\"./NasaAPIs\";import Loading from\"./Loading\";import{formatDisplayDate}from\"./Formatting\";import moment from\"moment\";import DocumentTitle from\"react-document-title\";var MarsRover=/*#__PURE__*/function(_React$Component){_inherits(MarsRover,_React$Component);var _super=_createSuper(MarsRover);function MarsRover(props){var _this;_classCallCheck(this,MarsRover);_this=_super.call(this,props);_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var today,dateComponents,photos,year,month,day,todayString,_photos;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});today=new Date();if(!_this.props.location.state.earth_date){_context.next=13;break;}dateComponents=_this.props.location.state.earth_date.split(\"-\");today.setDate(Number(dateComponents[2]));today.setMonth(Number(dateComponents[1])-1);today.setFullYear(Number(dateComponents[0]));_context.next=9;return fetchRover(_this.props.location.state.earth_date);case 9:photos=_context.sent;_this.setState({photos:photos});_context.next=25;break;case 13:year=today.getFullYear(),month=today.getMonth()+1,day=today.getDate();case 14:if(!(_this.state.photos.length===0)){_context.next=25;break;}todayString=moment(today).format(\"YYYY-M-D\");_context.next=18;return fetchRover(todayString);case 18:_photos=_context.sent;if(_photos){_context.next=22;break;}_this.setState({overRequested:true});return _context.abrupt(\"break\",25);case 22:if(_photos.length>0){_this.setState({photos:_photos});console.log(_photos);}else{if(Number(day)===1){month-=1;if(Number(month)===5||Number(month)===7||Number(month)===8||Number(month)===10||Number(month)===12){day=30;}else if(Number(month)===3){if(Number(year)%4===0){day=29;}else{day=28;}}else if(Number(month)===1){day=31;month=12;year-=1;}else{day=30;}}else{day-=1;}today.setMonth(month-1);today.setFullYear(year);today.setDate(day);}_context.next=14;break;case 25:_this.setState({currentDate:today,previousDate:today,loading:false});case 26:case\"end\":return _context.stop();}}},_callee);}));_this.componentDidUpdate=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var todayString,photos;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(_this.state.currentDate!==_this.state.previousDate)){_context2.next=10;break;}_this.setState({previousDate:_this.state.currentDate,photos:[],loading:true,overRequested:false});todayString=moment(_this.state.currentDate).format(\"YYYY-M-D\");_context2.next=5;return fetchRover(todayString);case 5:photos=_context2.sent;console.log(photos);// console.log(photos.length);\nif(photos.length===0){_this.setState({photos:photos,loading:false});}if(photos===null){_this.setState({overRequested:true,loading:false});}if(photos.length>0){_this.setState({photos:photos});_this.setState({loading:false});}case 10:case\"end\":return _context2.stop();}}},_callee2);}));_this.handleChange=function(event){_this.setState({currentDate:event});};_this.state={photos:[],currentDate:\"\",previousDate:\"\",loading:false,overRequested:false};return _this;}_createClass(MarsRover,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(DocumentTitle,{title:\"Mars Images\"},/*#__PURE__*/React.createElement(\"div\",{id:\"marsPage\",onClick:this.props.onClick},this.state.overRequested?/*#__PURE__*/React.createElement(\"div\",null,\"Too many requests to Nasa API \"):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"page-title d-xs-block d-md-none\"},/*#__PURE__*/React.createElement(\"div\",null,\"NASA\"),/*#__PURE__*/React.createElement(\"div\",null,\"Mars Rover Photos\")),/*#__PURE__*/React.createElement(\"h1\",{className:\"page-title d-none d-md-block\"},\"NASA Mars Rover Photos\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row photo-section\"},/*#__PURE__*/React.createElement(\"div\",{id:\"mars-date-picker\",className:\"col-12\"},/*#__PURE__*/React.createElement(DatePicker,{selected:this.state.currentDate,onChange:this.handleChange}))),this.state.loading?/*#__PURE__*/React.createElement(Loading,null):/*#__PURE__*/React.createElement(\"div\",{className:\"photo-container\"},this.state.photos.length===0?/*#__PURE__*/React.createElement(\"div\",{id:\"mars-photo-error\"},\"No photos on \",formatDisplayDate(this.state.currentDate)):/*#__PURE__*/React.createElement(\"div\",{className:\"row photo-section\"},this.state.photos.map(function(photo){return/*#__PURE__*/React.createElement(\"div\",{className:\"mars-photo col-lg-3 col-md-4 col-sm-6\",key:photo.id},/*#__PURE__*/React.createElement(NavLink,{to:{pathname:\"/mars/earth_date=\".concat(photo.earth_date,\"&photo_id=\").concat(photo.id),state:{email:_this2.props.location.state.email}}},/*#__PURE__*/React.createElement(\"img\",{src:photo.img_src,alt:\"mars image\",loading:\"lazy\"})));})))))));}}]);return MarsRover;}(React.Component);export{MarsRover as default};","map":{"version":3,"sources":["/Users/phillipyang/Desktop/Nasa-Images-v3/client/src/MarsRover.js"],"names":["React","DatePicker","NavLink","fetchRover","Loading","formatDisplayDate","moment","DocumentTitle","MarsRover","props","componentDidMount","setState","loading","today","Date","location","state","earth_date","dateComponents","split","setDate","Number","setMonth","setFullYear","photos","year","getFullYear","month","getMonth","day","getDate","length","todayString","format","overRequested","console","log","currentDate","previousDate","componentDidUpdate","handleChange","event","onClick","map","photo","id","pathname","email","img_src","Component"],"mappings":"u9BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,UAAP,KAAuB,kBAAvB,CACA,OAASC,OAAT,KAAwB,kBAAxB,CACA,OAASC,UAAT,KAA2B,YAA3B,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,OAASC,iBAAT,KAAkC,cAAlC,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,CACA,MAAOC,CAAAA,aAAP,KAA0B,sBAA1B,C,GAEqBC,CAAAA,S,kHACnB,mBAAYC,KAAZ,CAAmB,2CACjB,uBAAMA,KAAN,EADiB,MAUnBC,iBAVmB,sEAUC,sMAClB,MAAKC,QAAL,CAAc,CAAEC,OAAO,CAAE,IAAX,CAAd,EACIC,KAFc,CAEN,GAAIC,CAAAA,IAAJ,EAFM,KAGd,MAAKL,KAAL,CAAWM,QAAX,CAAoBC,KAApB,CAA0BC,UAHZ,0BAIZC,cAJY,CAIK,MAAKT,KAAL,CAAWM,QAAX,CAAoBC,KAApB,CAA0BC,UAA1B,CAAqCE,KAArC,CAA2C,GAA3C,CAJL,CAKhBN,KAAK,CAACO,OAAN,CAAcC,MAAM,CAACH,cAAc,CAAC,CAAD,CAAf,CAApB,EACAL,KAAK,CAACS,QAAN,CAAeD,MAAM,CAACH,cAAc,CAAC,CAAD,CAAf,CAAN,CAA4B,CAA3C,EACAL,KAAK,CAACU,WAAN,CAAkBF,MAAM,CAACH,cAAc,CAAC,CAAD,CAAf,CAAxB,EAPgB,sBAQKf,CAAAA,UAAU,CAAC,MAAKM,KAAL,CAAWM,QAAX,CAAoBC,KAApB,CAA0BC,UAA3B,CARf,QAQVO,MARU,eAShB,MAAKb,QAAL,CAAc,CAAEa,MAAM,CAANA,MAAF,CAAd,EATgB,+BAYZC,IAZY,CAYLZ,KAAK,CAACa,WAAN,EAZK,CAadC,KAbc,CAaNd,KAAK,CAACe,QAAN,GAAmB,CAbb,CAcdC,GAdc,CAcRhB,KAAK,CAACiB,OAAN,EAdQ,cAgBT,MAAKd,KAAL,CAAWQ,MAAX,CAAkBO,MAAlB,GAA6B,CAhBpB,2BAiBVC,WAjBU,CAiBI1B,MAAM,CAACO,KAAD,CAAN,CAAcoB,MAAd,CAAqB,UAArB,CAjBJ,wBAkBO9B,CAAAA,UAAU,CAAC6B,WAAD,CAlBjB,SAkBRR,OAlBQ,kBAmBTA,OAnBS,0BAoBZ,MAAKb,QAAL,CAAc,CAAEuB,aAAa,CAAE,IAAjB,CAAd,EApBY,2CAuBd,GAAIV,OAAM,CAACO,MAAP,CAAgB,CAApB,CAAuB,CACrB,MAAKpB,QAAL,CAAc,CAAEa,MAAM,CAANA,OAAF,CAAd,EACAW,OAAO,CAACC,GAAR,CAAYZ,OAAZ,EACD,CAHD,IAGO,CACL,GAAIH,MAAM,CAACQ,GAAD,CAAN,GAAgB,CAApB,CAAuB,CACrBF,KAAK,EAAI,CAAT,CACA,GACEN,MAAM,CAACM,KAAD,CAAN,GAAkB,CAAlB,EACAN,MAAM,CAACM,KAAD,CAAN,GAAkB,CADlB,EAEAN,MAAM,CAACM,KAAD,CAAN,GAAkB,CAFlB,EAGAN,MAAM,CAACM,KAAD,CAAN,GAAkB,EAHlB,EAIAN,MAAM,CAACM,KAAD,CAAN,GAAkB,EALpB,CAME,CACAE,GAAG,CAAG,EAAN,CACD,CARD,IAQO,IAAIR,MAAM,CAACM,KAAD,CAAN,GAAkB,CAAtB,CAAyB,CAC9B,GAAIN,MAAM,CAACI,IAAD,CAAN,CAAe,CAAf,GAAqB,CAAzB,CAA4B,CAC1BI,GAAG,CAAG,EAAN,CACD,CAFD,IAEO,CACLA,GAAG,CAAG,EAAN,CACD,CACF,CANM,IAMA,IAAIR,MAAM,CAACM,KAAD,CAAN,GAAkB,CAAtB,CAAyB,CAC9BE,GAAG,CAAG,EAAN,CACAF,KAAK,CAAG,EAAR,CACAF,IAAI,EAAI,CAAR,CACD,CAJM,IAIA,CACLI,GAAG,CAAG,EAAN,CACD,CACF,CAvBD,IAuBO,CACLA,GAAG,EAAI,CAAP,CACD,CACDhB,KAAK,CAACS,QAAN,CAAeK,KAAK,CAAG,CAAvB,EACAd,KAAK,CAACU,WAAN,CAAkBE,IAAlB,EACAZ,KAAK,CAACO,OAAN,CAAcS,GAAd,EACD,CAxDa,+BA2DlB,MAAKlB,QAAL,CAAc,CAAE0B,WAAW,CAAExB,KAAf,CAAsByB,YAAY,CAAEzB,KAApC,CAA2CD,OAAO,CAAE,KAApD,CAAd,EA3DkB,uDAVD,SAuEnB2B,kBAvEmB,sEAuEE,oKACf,MAAKvB,KAAL,CAAWqB,WAAX,GAA2B,MAAKrB,KAAL,CAAWsB,YADvB,4BAEjB,MAAK3B,QAAL,CAAc,CACZ2B,YAAY,CAAE,MAAKtB,KAAL,CAAWqB,WADb,CAEZb,MAAM,CAAE,EAFI,CAGZZ,OAAO,CAAE,IAHG,CAIZsB,aAAa,CAAE,KAJH,CAAd,EAMIF,WARa,CAQC1B,MAAM,CAAC,MAAKU,KAAL,CAAWqB,WAAZ,CAAN,CAA+BJ,MAA/B,CAAsC,UAAtC,CARD,wBASI9B,CAAAA,UAAU,CAAC6B,WAAD,CATd,QASXR,MATW,gBAUjBW,OAAO,CAACC,GAAR,CAAYZ,MAAZ,EACA;AACA,GAAIA,MAAM,CAACO,MAAP,GAAkB,CAAtB,CAAyB,CACvB,MAAKpB,QAAL,CAAc,CAAEa,MAAM,CAANA,MAAF,CAAUZ,OAAO,CAAE,KAAnB,CAAd,EACD,CACD,GAAIY,MAAM,GAAK,IAAf,CAAqB,CACnB,MAAKb,QAAL,CAAc,CAAEuB,aAAa,CAAE,IAAjB,CAAuBtB,OAAO,CAAE,KAAhC,CAAd,EACD,CACD,GAAIY,MAAM,CAACO,MAAP,CAAgB,CAApB,CAAuB,CACrB,MAAKpB,QAAL,CAAc,CAAEa,MAAM,CAANA,MAAF,CAAd,EACA,MAAKb,QAAL,CAAc,CAAEC,OAAO,CAAE,KAAX,CAAd,EACD,CArBgB,yDAvEF,SA+FnB4B,YA/FmB,CA+FJ,SAAAC,KAAK,CAAI,CACtB,MAAK9B,QAAL,CAAc,CAAE0B,WAAW,CAAEI,KAAf,CAAd,EACD,CAjGkB,CAEjB,MAAKzB,KAAL,CAAa,CACXQ,MAAM,CAAE,EADG,CAEXa,WAAW,CAAE,EAFF,CAGXC,YAAY,CAAE,EAHH,CAIX1B,OAAO,CAAE,KAJE,CAKXsB,aAAa,CAAE,KALJ,CAAb,CAFiB,aASlB,C,6DAyFQ,iBACP,mBACE,oBAAC,aAAD,EAAe,KAAK,CAAC,aAArB,eACE,2BAAK,EAAE,CAAC,UAAR,CAAmB,OAAO,CAAE,KAAKzB,KAAL,CAAWiC,OAAvC,EACG,KAAK1B,KAAL,CAAWkB,aAAX,cACC,gEADD,cAGC,4CACE,2BAAK,SAAS,CAAC,WAAf,eACE,0BAAI,SAAS,CAAC,iCAAd,eACE,sCADF,cAEE,mDAFF,CADF,cAKE,0BAAI,SAAS,CAAC,8BAAd,2BALF,cAQE,2BAAK,SAAS,CAAC,mBAAf,eAEE,2BAAK,EAAE,CAAC,kBAAR,CAA2B,SAAS,CAAC,QAArC,eACE,oBAAC,UAAD,EACE,QAAQ,CAAE,KAAKlB,KAAL,CAAWqB,WADvB,CAEE,QAAQ,CAAE,KAAKG,YAFjB,EADF,CAFF,CARF,CAiBG,KAAKxB,KAAL,CAAWJ,OAAX,cACC,oBAAC,OAAD,MADD,cAGC,2BAAK,SAAS,CAAC,iBAAf,EACG,KAAKI,KAAL,CAAWQ,MAAX,CAAkBO,MAAlB,GAA6B,CAA7B,cACC,2BAAK,EAAE,CAAC,kBAAR,kBACgB1B,iBAAiB,CAAC,KAAKW,KAAL,CAAWqB,WAAZ,CADjC,CADD,cAKC,2BAAK,SAAS,CAAC,mBAAf,EACG,KAAKrB,KAAL,CAAWQ,MAAX,CAAkBmB,GAAlB,CAAsB,SAAAC,KAAK,CAAI,CAC9B,mBACE,2BACE,SAAS,CAAC,uCADZ,CAEE,GAAG,CAAEA,KAAK,CAACC,EAFb,eAIE,oBAAC,OAAD,EACE,EAAE,CAAE,CACFC,QAAQ,4BAAqBF,KAAK,CAAC3B,UAA3B,sBAAkD2B,KAAK,CAACC,EAAxD,CADN,CAEF7B,KAAK,CAAE,CACL+B,KAAK,CAAE,MAAI,CAACtC,KAAL,CAAWM,QAAX,CAAoBC,KAApB,CAA0B+B,KAD5B,CAFL,CADN,eAQE,2BACE,GAAG,CAAEH,KAAK,CAACI,OADb,CAEE,GAAG,CAAC,YAFN,CAGE,OAAO,CAAC,MAHV,EARF,CAJF,CADF,CAqBD,CAtBA,CADH,CANJ,CApBJ,CADF,CAJJ,CADF,CADF,CAmED,C,uBAvKoChD,KAAK,CAACiD,S,SAAxBzC,S","sourcesContent":["import React from \"react\";\nimport DatePicker from \"react-datepicker\";\nimport { NavLink } from \"react-router-dom\";\nimport { fetchRover } from \"./NasaAPIs\";\nimport Loading from \"./Loading\";\nimport { formatDisplayDate } from \"./Formatting\";\nimport moment from \"moment\";\nimport DocumentTitle from \"react-document-title\";\n\nexport default class MarsRover extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      photos: [],\n      currentDate: \"\",\n      previousDate: \"\",\n      loading: false,\n      overRequested: false\n    };\n  }\n  componentDidMount = async () => {\n    this.setState({ loading: true });\n    var today = new Date();\n    if (this.props.location.state.earth_date) {\n      var dateComponents = this.props.location.state.earth_date.split(\"-\");\n      today.setDate(Number(dateComponents[2]));\n      today.setMonth(Number(dateComponents[1]) - 1);\n      today.setFullYear(Number(dateComponents[0]));\n      const photos = await fetchRover(this.props.location.state.earth_date);\n      this.setState({ photos });\n      \n    } else {\n      var year = today.getFullYear(),\n        month = today.getMonth() + 1,\n        day = today.getDate();\n\n      while (this.state.photos.length === 0) {\n        var todayString = moment(today).format(\"YYYY-M-D\");\n        const photos = await fetchRover(todayString);\n        if (!photos) {\n          this.setState({ overRequested: true });\n          break;\n        }\n        if (photos.length > 0) {\n          this.setState({ photos });\n          console.log(photos);\n        } else {\n          if (Number(day) === 1) {\n            month -= 1;\n            if (\n              Number(month) === 5 ||\n              Number(month) === 7 ||\n              Number(month) === 8 ||\n              Number(month) === 10 ||\n              Number(month) === 12\n            ) {\n              day = 30;\n            } else if (Number(month) === 3) {\n              if (Number(year) % 4 === 0) {\n                day = 29;\n              } else {\n                day = 28;\n              }\n            } else if (Number(month) === 1) {\n              day = 31;\n              month = 12;\n              year -= 1;\n            } else {\n              day = 30;\n            }\n          } else {\n            day -= 1;\n          }\n          today.setMonth(month - 1);\n          today.setFullYear(year);\n          today.setDate(day);\n        }\n      }\n    }\n    this.setState({ currentDate: today, previousDate: today, loading: false });\n  };\n  componentDidUpdate = async () => {\n    if (this.state.currentDate !== this.state.previousDate) {\n      this.setState({\n        previousDate: this.state.currentDate,\n        photos: [],\n        loading: true,\n        overRequested: false\n      });\n      var todayString = moment(this.state.currentDate).format(\"YYYY-M-D\");\n      const photos = await fetchRover(todayString);\n      console.log(photos);\n      // console.log(photos.length);\n      if (photos.length === 0) {\n        this.setState({ photos, loading: false });\n      }\n      if (photos === null) {\n        this.setState({ overRequested: true, loading: false });\n      }\n      if (photos.length > 0) {\n        this.setState({ photos });\n        this.setState({ loading: false });\n      }\n    }\n  };\n  handleChange = event => {\n    this.setState({ currentDate: event });\n  };\n  render() {\n    return (\n      <DocumentTitle title=\"Mars Images\">\n        <div id=\"marsPage\" onClick={this.props.onClick}>\n          {this.state.overRequested ? (\n            <div>Too many requests to Nasa API </div>\n          ) : (\n            <div>\n              <div className=\"container\">\n                <h1 className=\"page-title d-xs-block d-md-none\">\n                  <div>NASA</div>\n                  <div>Mars Rover Photos</div>\n                </h1>\n                <h1 className=\"page-title d-none d-md-block\">\n                  NASA Mars Rover Photos\n                </h1>\n                <div className=\"row photo-section\">\n                  {/* <div id=\"mars-photo-date\" className=\"col-12\">{formatDisplayDate(this.state.currentDate)}</div> */}\n                  <div id=\"mars-date-picker\" className=\"col-12\">\n                    <DatePicker\n                      selected={this.state.currentDate}\n                      onChange={this.handleChange}\n                    />\n                  </div>\n                </div>\n                {this.state.loading ? (\n                  <Loading />\n                ) : (\n                  <div className=\"photo-container\">\n                    {this.state.photos.length === 0 ? (\n                      <div id=\"mars-photo-error\">\n                        No photos on {formatDisplayDate(this.state.currentDate)}\n                      </div>\n                    ) : (\n                      <div className=\"row photo-section\">\n                        {this.state.photos.map(photo => {\n                          return (\n                            <div\n                              className=\"mars-photo col-lg-3 col-md-4 col-sm-6\"\n                              key={photo.id}\n                            >\n                              <NavLink\n                                to={{\n                                  pathname:`/mars/earth_date=${photo.earth_date}&photo_id=${photo.id}`,\n                                  state: {\n                                    email: this.props.location.state.email\n                                  }\n                                }}\n                              >\n                                <img\n                                  src={photo.img_src}\n                                  alt=\"mars image\"\n                                  loading=\"lazy\"\n                                />\n                              </NavLink>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    )}\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </DocumentTitle>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}