{"ast":null,"code":"import _regeneratorRuntime from\"/Users/phillipyang/Desktop/Nasa-Images-v4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/phillipyang/Desktop/Nasa-Images-v4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/phillipyang/Desktop/Nasa-Images-v4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/phillipyang/Desktop/Nasa-Images-v4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/phillipyang/Desktop/Nasa-Images-v4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/phillipyang/Desktop/Nasa-Images-v4/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{fetchAPOD,fetchApodFavorites,BACK_SERVER_URL}from'./NasaAPIs';import{formatDisplayDate}from'./Formatting';import Loading from'./Loading';import Iframe from'react-iframe';import thumbnail from'./images/galaxy.jpg';import{addPhotoNotification,removePhotoNotification}from'./Notifications';import DocumentTitle from\"react-document-title\";import axios from'axios';var API=\"https://itp404-final-project-yangphil.herokuapp.com/api/favorites\";var APOD=/*#__PURE__*/function(_React$Component){_inherits(APOD,_React$Component);var _super=_createSuper(APOD);function APOD(props){var _this;_classCallCheck(this,APOD);_this=_super.call(this,props);_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var apod,currentDate,dateComponents,year,month,day,i,newDate;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});_context.next=3;return fetchAPOD();case 3:apod=_context.sent;if(!apod.error){_context.next=8;break;}_this.setState({overRequestedAPI:true});_context.next=30;break;case 8:_this.setState({apod:apod});_this.state.previousSeven.push([]);_this.state.previousSeven[0].push(apod);_this.setState({mainLoading:false,todaysDate:apod.date});currentDate=apod.date;dateComponents=currentDate.split('-');year=Number(dateComponents[0]),month=Number(dateComponents[1]),day=Number(dateComponents[2]);i=1;case 16:if(!(i<7)){_context.next=28;break;}if(day===1){month-=1;if(month===5||month===7||month===8||month===10||month===12){day=30;}else if(month===3){if(year%4===0){day=29;}else{day=28;}}else if(month===1){day=31;month=12;year-=1;}else{day=30;}}else{day-=1;}newDate=String(year)+\"-\"+String(month)+\"-\"+String(day);_this.state.previousSeven.push([]);_context.t0=_this.state.previousSeven[i];_context.next=23;return fetchAPOD(newDate);case 23:_context.t1=_context.sent;_context.t0.push.call(_context.t0,_context.t1);case 25:i++;_context.next=16;break;case 28:if(apod.media_type!==\"video\"){_this.checkIfLiked(apod);}_this.setState({loading:false,description:apod.explanation});case 30:case\"end\":return _context.stop();}}},_callee);}));_this.checkIfLiked=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(photo){var urlComponents,id,acc,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:urlComponents=photo.hdurl.split('/');id=urlComponents[urlComponents.length-1];acc={_id:_this.props.location.state.email,data:{_id:id}};_context2.next=5;return axios.post(\"\".concat(BACK_SERVER_URL,\"/account/favorites/apod/fetch\"),acc);case 5:res=_context2.sent;if(res.status!==200){_this.setState({liked:false});}else{_this.setState({liked:true});}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handleClick=function(photo){window.scrollTo({top:240,behavior:'smooth'});if(photo.date!==_this.state.apod.date){_this.setState({apod:photo});if(photo.media_type!==\"video\"){_this.checkIfLiked(photo);}}};_this.showDescription=function(){_this.setState({descriptionSection:\"show-description\",descriptionButton:\"hide-description\"});};_this.hideDescription=function(){_this.setState({descriptionSection:\"hide-description\",descriptionButton:\"show-description\"});};_this.toggleLike=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var urlComponents,id,newFav;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:urlComponents=_this.state.apod.hdurl.split('/');id=urlComponents[urlComponents.length-1];if(!_this.state.liked){newFav={_id:_this.props.location.state.email,data:{_id:id,url:_this.state.apod.hdurl,date:_this.state.apod.date,comment:\"\",api:\"apod\"}};axios.put(\"\".concat(BACK_SERVER_URL,\"/account/favorites/apod/add\"),newFav).then(function(response){addPhotoNotification(id);}).catch(function(err){// console.log(err);\n});}else if(_this.state.liked){axios.delete('/favorites/apod/delete',{// for delete, all data must be wrapped in data\ndata:{_id:_this.props.location.state.email,data:{_id:id}}}).then(function(response){removePhotoNotification(id);}).catch(function(err){// console.log(\"didn't delete\");\n});}_this.setState({liked:!_this.state.liked});case 4:case\"end\":return _context3.stop();}}},_callee3);}));_this.lastTap=null;_this.handleDoubleTap=function(){var now=Date.now();var DOUBLE_PRESS_DELAY=300;if(_this.lastTap&&now-_this.lastTap<DOUBLE_PRESS_DELAY){_this.toggleLike();}else{_this.lastTap=now;}};_this.state={apod:[],previousSeven:[],todaysDate:'',loading:false,description:'',descriptionSection:'hide-description',descriptionButton:'show-description',overRequestedAPIAPI:false,liked:false};return _this;}_createClass(APOD,[{key:\"render\",value:function render(){var _this2=this;if(this.state.description!==this.state.apod.explanation){this.setState({descriptionSection:\"hide-description\",descriptionButton:\"show-description\",description:this.state.apod.explanation});}return/*#__PURE__*/React.createElement(DocumentTitle,{title:\"APOD\"},/*#__PURE__*/React.createElement(\"div\",{id:\"homePage\",onClick:this.props.onClick},this.state.overRequestedAPIAPI?/*#__PURE__*/React.createElement(\"div\",null,\"Too many requests to Nasa API\"):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"page-title d-xs-block d-md-none\"},/*#__PURE__*/React.createElement(\"div\",null,\"NASA\"),/*#__PURE__*/React.createElement(\"div\",null,\"Photo of the Day\")),/*#__PURE__*/React.createElement(\"h1\",{className:\"page-title d-none d-md-block\"},\"Astronomy Picture of the Day\"),this.state.loading?/*#__PURE__*/React.createElement(Loading,null):/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{id:\"main-image\",className:\"col-lg-9 col-md-9 col-sm-12\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"column-title col-12\"},/*#__PURE__*/React.createElement(\"strong\",null,this.state.todaysDate===this.state.apod.date?\"Today\":formatDisplayDate(this.state.apod.date))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},this.state.apod.media_type!==\"video\"?/*#__PURE__*/React.createElement(\"img\",{src:this.state.apod.hdurl,onClick:this.handleDoubleTap,alt:this.state.apod.title}):/*#__PURE__*/React.createElement(Iframe,{src:this.state.apod.url,width:\"100%\",frameBorder:\"0\",allowFullScreen:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 apod-details\"},this.state.apod.media_type!==\"video\"?/*#__PURE__*/React.createElement(\"p\",{className:\"icon-holder\",onClick:this.toggleLike},/*#__PURE__*/React.createElement(\"img\",{src:this.state.liked?require('./images/filledHeart.png'):require('./images/emptyHeart.png'),className:\"heart-icon\",alt:\"heart icon\"})):/*#__PURE__*/React.createElement(\"p\",null),/*#__PURE__*/React.createElement(\"p\",{id:\"apod-date\"},formatDisplayDate(this.state.apod.date)),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"strong\",null,this.state.apod.title)),/*#__PURE__*/React.createElement(\"p\",{id:\"apod-description-button\",className:\"\".concat(this.state.descriptionButton,\" d-xs-block d-md-none\"),onClick:this.showDescription},\"Click to Read Description...\"),/*#__PURE__*/React.createElement(\"div\",{className:\"d-xs-block d-md-none\",onClick:this.hideDescription},/*#__PURE__*/React.createElement(\"p\",{className:this.state.descriptionSection},this.state.description)),/*#__PURE__*/React.createElement(\"p\",{className:\"d-none d-md-block\"},this.state.apod.explanation),this.state.apod.copyright?/*#__PURE__*/React.createElement(\"p\",null,\"Credit: \",this.state.apod.copyright):/*#__PURE__*/React.createElement(\"p\",null))),/*#__PURE__*/React.createElement(\"div\",{id:\"previous-image-column\",className:\"col-lg-3 col-md-3 col-sm-12\"},/*#__PURE__*/React.createElement(\"h3\",{className:\"column-title col-12\"},/*#__PURE__*/React.createElement(\"strong\",null,\"Last 7 Days\")),this.state.previousSeven.map(function(last){return/*#__PURE__*/React.createElement(\"img\",{src:last[0].media_type===\"video\"?thumbnail:last[0].hdurl,className:_this2.state.apod.date===last[0].date?\"col-12 previous-image active\":\"col-12 previous-image\",loading:\"lazy\",key:last[0].title,onClick:function onClick(){_this2.handleClick(last[0]);},alt:last[0].title});})))))));}}]);return APOD;}(React.Component);// class DescriptionButton extends React.Component {\n// \tconstructor(props){\n// \t\tsuper(props);\n// \t\tthis.state = {\n// \t\t\tdescription: '',\n// \t\t\thideDescription: 'hideDescription'\n// \t\t};\n// \t}\n// \tcomponentDidMount() {\n// \t\tthis.setState({ description: this.props.description });\n// \t\tconsole.log(this.state.description);\n// \t\tconsole.log(this.props.description);\n// \t}\n// \thandleButtonClick = () => {\n// \t\tthis.setState({ hideDescription: \"show-description\"});\n// \t}\n// \trender() {\n// \t\tif(this.state.description !== this.props.description) {\n// \t\t\tthis.setState({ hideDescription: \"hideDescription\", description: this.props.description});\n// \t\t}\n// \t\treturn (\n// \t\t\t<div>\n// \t\t\t\t<p id=\"apod-description-button\" className=\"col-12\" onClick={this.handleButtonClick}>Click to Read Description...</p>\n// \t\t\t\t<p id=\"apod-description\" className={this.state.hideDescription}>{this.state.description}</p>\n// \t\t\t</div>\t\t\t\t\t\n// \t\t);\n// \t}\n// }\nexport{APOD as default};","map":{"version":3,"sources":["/Users/phillipyang/Desktop/Nasa-Images-v4/client/src/APOD.js"],"names":["React","fetchAPOD","fetchApodFavorites","BACK_SERVER_URL","formatDisplayDate","Loading","Iframe","thumbnail","addPhotoNotification","removePhotoNotification","DocumentTitle","axios","API","APOD","props","componentDidMount","setState","loading","apod","error","overRequestedAPI","state","previousSeven","push","mainLoading","todaysDate","date","currentDate","dateComponents","split","year","Number","month","day","i","newDate","String","media_type","checkIfLiked","description","explanation","photo","urlComponents","hdurl","id","length","acc","_id","location","email","data","post","res","status","liked","handleClick","window","scrollTo","top","behavior","showDescription","descriptionSection","descriptionButton","hideDescription","toggleLike","newFav","url","comment","api","put","then","response","catch","err","delete","lastTap","handleDoubleTap","now","Date","DOUBLE_PRESS_DELAY","overRequestedAPIAPI","onClick","title","require","copyright","map","last","Component"],"mappings":"u9BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,CAAoBC,kBAApB,CAAwCC,eAAxC,KAA+D,YAA/D,CACA,OAASC,iBAAT,KAAkC,cAAlC,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,MAAP,KAAmB,cAAnB,CACA,MAAOC,CAAAA,SAAP,KAAsB,qBAAtB,CACA,OAASC,oBAAT,CAA+BC,uBAA/B,KAA8D,iBAA9D,CACA,MAAOC,CAAAA,aAAP,KAA0B,sBAA1B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,GAAMC,CAAAA,GAAG,CAAG,mEAAZ,C,GAGqBC,CAAAA,I,wGACjB,cAAYC,KAAZ,CAAmB,sCACrB,uBAAMA,KAAN,EADqB,MActBC,iBAdsB,sEAcF,gMACnB,MAAKC,QAAL,CAAe,CAAEC,OAAO,CAAE,IAAX,CAAf,EADmB,sBAEAhB,CAAAA,SAAS,EAFT,QAEbiB,IAFa,mBAGfA,IAAI,CAACC,KAHU,yBAIlB,MAAKH,QAAL,CAAc,CAAEI,gBAAgB,CAAE,IAApB,CAAd,EAJkB,8BAMlB,MAAKJ,QAAL,CAAc,CAAEE,IAAI,CAAJA,IAAF,CAAd,EACA,MAAKG,KAAL,CAAWC,aAAX,CAAyBC,IAAzB,CAA8B,EAA9B,EACA,MAAKF,KAAL,CAAWC,aAAX,CAAyB,CAAzB,EAA4BC,IAA5B,CAAiCL,IAAjC,EACA,MAAKF,QAAL,CAAe,CAAEQ,WAAW,CAAE,KAAf,CAAsBC,UAAU,CAAEP,IAAI,CAACQ,IAAvC,CAAf,EACMC,WAVY,CAUET,IAAI,CAACQ,IAVP,CAWZE,cAXY,CAWKD,WAAW,CAACE,KAAZ,CAAkB,GAAlB,CAXL,CAYdC,IAZc,CAYPC,MAAM,CAACH,cAAc,CAAC,CAAD,CAAf,CAZC,CAYoBI,KAZpB,CAY4BD,MAAM,CAACH,cAAc,CAAC,CAAD,CAAf,CAZlC,CAYuDK,GAZvD,CAY6DF,MAAM,CAACH,cAAc,CAAC,CAAD,CAAf,CAZnE,CAaTM,CAbS,CAaL,CAbK,cAaFA,CAAC,CAAG,CAbF,2BAcjB,GAAID,GAAG,GAAK,CAAZ,CAAc,CACbD,KAAK,EAAI,CAAT,CACA,GAAGA,KAAK,GAAK,CAAV,EAAeA,KAAK,GAAK,CAAzB,EAA8BA,KAAK,GAAK,CAAxC,EAA6CA,KAAK,GAAK,EAAvD,EAA6DA,KAAK,GAAK,EAA1E,CAA8E,CAC7EC,GAAG,CAAG,EAAN,CACA,CAFD,IAEO,IAAID,KAAK,GAAK,CAAd,CAAkB,CACxB,GAAIF,IAAI,CAAG,CAAP,GAAa,CAAjB,CAAoB,CACnBG,GAAG,CAAG,EAAN,CACA,CAFD,IAEO,CACNA,GAAG,CAAG,EAAN,CACA,CACD,CANM,IAMA,IAAID,KAAK,GAAK,CAAd,CAAiB,CACvBC,GAAG,CAAG,EAAN,CACAD,KAAK,CAAG,EAAR,CACAF,IAAI,EAAI,CAAR,CACA,CAJM,IAIA,CACNG,GAAG,CAAG,EAAN,CACA,CACD,CAjBD,IAiBO,CACNA,GAAG,EAAI,CAAP,CACA,CACKE,OAlCW,CAkCDC,MAAM,CAACN,IAAD,CAAN,CAAe,GAAf,CAAqBM,MAAM,CAACJ,KAAD,CAA3B,CAAqC,GAArC,CAA2CI,MAAM,CAACH,GAAD,CAlChD,CAmCjB,MAAKZ,KAAL,CAAWC,aAAX,CAAyBC,IAAzB,CAA8B,EAA9B,EAnCiB,YAoCjB,MAAKF,KAAL,CAAWC,aAAX,CAAyBY,CAAzB,CApCiB,wBAoCuBjC,CAAAA,SAAS,CAACkC,OAAD,CApChC,+CAoCWZ,IApCX,uCAaKW,CAAC,EAbN,gCAsClB,GAAGhB,IAAI,CAACmB,UAAL,GAAoB,OAAvB,CAAgC,CAC/B,MAAKC,YAAL,CAAkBpB,IAAlB,EACA,CAED,MAAKF,QAAL,CAAc,CAAEC,OAAO,CAAE,KAAX,CAAkBsB,WAAW,CAAErB,IAAI,CAACsB,WAApC,CAAd,EA1CkB,uDAdE,SA4DtBF,YA5DsB,2FA4DP,kBAAOG,KAAP,mJAERC,aAFQ,CAEQD,KAAK,CAACE,KAAN,CAAYd,KAAZ,CAAkB,GAAlB,CAFR,CAGRe,EAHQ,CAGHF,aAAa,CAACA,aAAa,CAACG,MAAd,CAAuB,CAAxB,CAHV,CAIRC,GAJQ,CAIF,CACXC,GAAG,CAAE,MAAKjC,KAAL,CAAWkC,QAAX,CAAoB3B,KAApB,CAA0B4B,KADpB,CAEXC,IAAI,CAAE,CACLH,GAAG,CAAEH,EADA,CAFK,CAJE,wBAUEjC,CAAAA,KAAK,CAACwC,IAAN,WAAchD,eAAd,kCAA8D2C,GAA9D,CAVF,QAUVM,GAVU,gBAWd,GAAGA,GAAG,CAACC,MAAJ,GAAe,GAAlB,CAAuB,CACtB,MAAKrC,QAAL,CAAc,CAAEsC,KAAK,CAAE,KAAT,CAAd,EACA,CAFD,IAEO,CACN,MAAKtC,QAAL,CAAc,CAAEsC,KAAK,CAAE,IAAT,CAAd,EACA,CAfa,wDA5DO,sEA6EtBC,WA7EsB,CA6ER,SAACd,KAAD,CAAW,CACxBe,MAAM,CAACC,QAAP,CAAgB,CAACC,GAAG,CAAE,GAAN,CAAWC,QAAQ,CAAE,QAArB,CAAhB,EACA,GAAGlB,KAAK,CAACf,IAAN,GAAe,MAAKL,KAAL,CAAWH,IAAX,CAAgBQ,IAAlC,CAAwC,CACvC,MAAKV,QAAL,CAAc,CAAEE,IAAI,CAAEuB,KAAR,CAAd,EACA,GAAGA,KAAK,CAACJ,UAAN,GAAqB,OAAxB,CAAiC,CAChC,MAAKC,YAAL,CAAmBG,KAAnB,EACA,CACD,CACD,CArFqB,OAsFtBmB,eAtFsB,CAsFJ,UAAM,CACvB,MAAK5C,QAAL,CAAc,CAAE6C,kBAAkB,CAAE,kBAAtB,CAA0CC,iBAAiB,CAAE,kBAA7D,CAAd,EACA,CAxFqB,OAyFtBC,eAzFsB,CAyFJ,UAAM,CACvB,MAAK/C,QAAL,CAAc,CAAE6C,kBAAkB,CAAE,kBAAtB,CAA0CC,iBAAiB,CAAE,kBAA7D,CAAd,EACA,CA3FqB,OA4FtBE,UA5FsB,sEA4FT,oKACNtB,aADM,CACU,MAAKrB,KAAL,CAAWH,IAAX,CAAgByB,KAAhB,CAAsBd,KAAtB,CAA4B,GAA5B,CADV,CAENe,EAFM,CAEDF,aAAa,CAACA,aAAa,CAACG,MAAd,CAAuB,CAAxB,CAFZ,CAGZ,GAAG,CAAC,MAAKxB,KAAL,CAAWiC,KAAf,CAAqB,CACdW,MADc,CACL,CACFlB,GAAG,CAAE,MAAKjC,KAAL,CAAWkC,QAAX,CAAoB3B,KAApB,CAA0B4B,KAD7B,CAEFC,IAAI,CAAE,CACjBH,GAAG,CAAEH,EADY,CAEjBsB,GAAG,CAAE,MAAK7C,KAAL,CAAWH,IAAX,CAAgByB,KAFJ,CAGjBjB,IAAI,CAAE,MAAKL,KAAL,CAAWH,IAAX,CAAgBQ,IAHL,CAIjByC,OAAO,CAAE,EAJQ,CAKjBC,GAAG,CAAE,MALY,CAFJ,CADK,CAWpBzD,KAAK,CAAC0D,GAAN,WAAalE,eAAb,gCAA2D8D,MAA3D,EACEK,IADF,CACO,SAAAC,QAAQ,CAAI,CACjB/D,oBAAoB,CAACoC,EAAD,CAApB,CACA,CAHF,EAIE4B,KAJF,CAIQ,SAAAC,GAAG,CAAI,CACb;AACA,CANF,EAQA,CAnBD,IAoBK,IAAG,MAAKpD,KAAL,CAAWiC,KAAd,CAAoB,CACxB3C,KAAK,CAAC+D,MAAN,CAAa,wBAAb,CAAuC,CACtC;AACYxB,IAAI,CAAE,CACjBH,GAAG,CAAE,MAAKjC,KAAL,CAAWkC,QAAX,CAAoB3B,KAApB,CAA0B4B,KADd,CAEjBC,IAAI,CAAE,CACLH,GAAG,CAAEH,EADA,CAFW,CAFoB,CAAvC,EASC0B,IATD,CASM,SAAAC,QAAQ,CAAI,CACjB9D,uBAAuB,CAACmC,EAAD,CAAvB,CACA,CAXD,EAYC4B,KAZD,CAYO,SAAAC,GAAG,CAAI,CACb;AACA,CAdD,EAgBA,CACD,MAAKzD,QAAL,CAAc,CAAEsC,KAAK,CAAE,CAAC,MAAKjC,KAAL,CAAWiC,KAArB,CAAd,EAzCY,wDA5FS,SAwItBqB,OAxIsB,CAwIZ,IAxIY,OAyItBC,eAzIsB,CAyIJ,UAAM,CACvB,GAAMC,CAAAA,GAAG,CAAGC,IAAI,CAACD,GAAL,EAAZ,CACA,GAAME,CAAAA,kBAAkB,CAAG,GAA3B,CACA,GAAI,MAAKJ,OAAL,EAAiBE,GAAG,CAAG,MAAKF,OAAZ,CAAuBI,kBAA3C,CAA+D,CAC9D,MAAKf,UAAL,GACA,CAFD,IAEO,CACN,MAAKW,OAAL,CAAeE,GAAf,CACA,CACD,CAjJqB,CAEf,MAAKxD,KAAL,CAAY,CACjBH,IAAI,CAAE,EADW,CAEjBI,aAAa,CAAE,EAFE,CAGjBG,UAAU,CAAE,EAHK,CAIjBR,OAAO,CAAE,KAJQ,CAKjBsB,WAAW,CAAE,EALI,CAMjBsB,kBAAkB,CAAE,kBANH,CAOjBC,iBAAiB,CAAE,kBAPF,CAQjBkB,mBAAmB,CAAE,KARJ,CASjB1B,KAAK,CAAE,KATU,CAAZ,CAFe,aAarB,C,wDAsIW,iBACX,GAAG,KAAKjC,KAAL,CAAWkB,WAAX,GAA2B,KAAKlB,KAAL,CAAWH,IAAX,CAAgBsB,WAA9C,CAA2D,CAC1D,KAAKxB,QAAL,CAAc,CAAE6C,kBAAkB,CAAE,kBAAtB,CAA0CC,iBAAiB,CAAE,kBAA7D,CAAiFvB,WAAW,CAAE,KAAKlB,KAAL,CAAWH,IAAX,CAAgBsB,WAA9G,CAAd,EACA,CACK,mBACL,oBAAC,aAAD,EAAe,KAAK,CAAC,MAArB,eACC,2BAAK,EAAE,CAAC,UAAR,CAAmB,OAAO,CAAE,KAAK1B,KAAL,CAAWmE,OAAvC,EACE,KAAK5D,KAAL,CAAW2D,mBAAX,cAAiC,+DAAjC,cACA,4CACC,2BAAK,SAAS,CAAC,WAAf,eACC,0BAAI,SAAS,CAAC,iCAAd,eAAgD,sCAAhD,cAA+D,kDAA/D,CADD,cAEC,0BAAI,SAAS,CAAC,8BAAd,iCAFD,CAGE,KAAK3D,KAAL,CAAWJ,OAAX,cAAqB,oBAAC,OAAD,MAArB,cACA,2BAAK,SAAS,CAAC,KAAf,eACC,2BAAK,EAAE,CAAC,YAAR,CAAqB,SAAS,CAAC,6BAA/B,eACC,0BAAI,SAAS,CAAC,qBAAd,eAAoC,kCAAS,KAAKI,KAAL,CAAWI,UAAX,GAA0B,KAAKJ,KAAL,CAAWH,IAAX,CAAgBQ,IAA1C,CAAiD,OAAjD,CAA2DtB,iBAAiB,CAAC,KAAKiB,KAAL,CAAWH,IAAX,CAAgBQ,IAAjB,CAArF,CAApC,CADD,cAEC,2BAAK,SAAS,CAAC,QAAf,EACE,KAAKL,KAAL,CAAWH,IAAX,CAAgBmB,UAAhB,GAA+B,OAA/B,cACA,2BAAK,GAAG,CAAE,KAAKhB,KAAL,CAAWH,IAAX,CAAgByB,KAA1B,CAAiC,OAAO,CAAE,KAAKiC,eAA/C,CAAgE,GAAG,CAAE,KAAKvD,KAAL,CAAWH,IAAX,CAAgBgE,KAArF,EADA,cAEA,oBAAC,MAAD,EAAQ,GAAG,CAAE,KAAK7D,KAAL,CAAWH,IAAX,CAAgBgD,GAA7B,CAAkC,KAAK,CAAC,MAAxC,CAA8C,WAAW,CAAC,GAA1D,CAA8D,eAAe,KAA7E,EAHF,CAFD,cAQC,2BAAK,SAAS,CAAC,qBAAf,EACE,KAAK7C,KAAL,CAAWH,IAAX,CAAgBmB,UAAhB,GAA+B,OAA/B,cACA,yBAAG,SAAS,CAAC,aAAb,CAA2B,OAAO,CAAE,KAAK2B,UAAzC,eACC,2BACC,GAAG,CAAE,KAAK3C,KAAL,CAAWiC,KAAX,CAAmB6B,OAAO,CAAC,0BAAD,CAA1B,CAAyDA,OAAO,CAAC,yBAAD,CADtE,CAEC,SAAS,CAAC,YAFX,CAGC,GAAG,CAAC,YAHL,EADD,CADA,cAOO,6BART,cAUC,yBAAG,EAAE,CAAC,WAAN,EAAmB/E,iBAAiB,CAAC,KAAKiB,KAAL,CAAWH,IAAX,CAAgBQ,IAAjB,CAApC,CAVD,cAWC,0CAAG,kCAAS,KAAKL,KAAL,CAAWH,IAAX,CAAgBgE,KAAzB,CAAH,CAXD,cAYC,yBAAG,EAAE,CAAC,yBAAN,CAAgC,SAAS,WAAK,KAAK7D,KAAL,CAAWyC,iBAAhB,yBAAzC,CAAmG,OAAO,CAAE,KAAKF,eAAjH,iCAZD,cAaC,2BAAK,SAAS,CAAC,sBAAf,CAAsC,OAAO,CAAE,KAAKG,eAApD,eACC,yBAAG,SAAS,CAAE,KAAK1C,KAAL,CAAWwC,kBAAzB,EAA+C,KAAKxC,KAAL,CAAWkB,WAA1D,CADD,CAbD,cAgBC,yBAAG,SAAS,CAAC,mBAAb,EAAkC,KAAKlB,KAAL,CAAWH,IAAX,CAAgBsB,WAAlD,CAhBD,CAiBE,KAAKnB,KAAL,CAAWH,IAAX,CAAgBkE,SAAhB,cACA,wCAAY,KAAK/D,KAAL,CAAWH,IAAX,CAAgBkE,SAA5B,CADA,cAC6C,6BAlB/C,CARD,CADD,cA+BC,2BAAK,EAAE,CAAC,uBAAR,CAAgC,SAAS,CAAC,6BAA1C,eACC,0BAAI,SAAS,CAAC,qBAAd,eAAoC,gDAApC,CADD,CAEE,KAAK/D,KAAL,CAAWC,aAAX,CAAyB+D,GAAzB,CAA6B,SAAAC,IAAI,CAAI,CACrC,mBACC,2BAAK,GAAG,CAAEA,IAAI,CAAC,CAAD,CAAJ,CAAQjD,UAAR,GAAuB,OAAvB,CAAiC9B,SAAjC,CAA6C+E,IAAI,CAAC,CAAD,CAAJ,CAAQ3C,KAA/D,CAAsE,SAAS,CAAE,MAAI,CAACtB,KAAL,CAAWH,IAAX,CAAgBQ,IAAhB,GAAyB4D,IAAI,CAAC,CAAD,CAAJ,CAAQ5D,IAAjC,CAAwC,8BAAxC,CAAyE,uBAA1J,CAAmL,OAAO,CAAC,MAA3L,CAAkM,GAAG,CAAE4D,IAAI,CAAC,CAAD,CAAJ,CAAQJ,KAA/M,CAAsN,OAAO,CAAE,kBAAM,CAAC,MAAI,CAAC3B,WAAL,CAAiB+B,IAAI,CAAC,CAAD,CAArB,EAA0B,CAAhQ,CAAkQ,GAAG,CAAEA,IAAI,CAAC,CAAD,CAAJ,CAAQJ,KAA/Q,EADD,CAIA,CALA,CAFF,CA/BD,CAJF,CADD,CAFF,CADD,CADK,CA0DH,C,kBAlN6BlF,KAAK,CAACuF,S,EAqNxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;OAjPqB1E,I","sourcesContent":["import React from 'react';\nimport { fetchAPOD, fetchApodFavorites, BACK_SERVER_URL } from './NasaAPIs';\nimport { formatDisplayDate } from './Formatting';\nimport Loading from './Loading';\nimport Iframe from 'react-iframe';\nimport thumbnail from './images/galaxy.jpg';\nimport { addPhotoNotification, removePhotoNotification } from './Notifications';\nimport DocumentTitle from \"react-document-title\";\nimport axios from 'axios';\nconst API = \"https://itp404-final-project-yangphil.herokuapp.com/api/favorites\";\n\n\nexport default class APOD extends React.Component {\n    constructor(props) {\n\t\tsuper(props);\n        this.state ={\n\t\t\tapod: [],\n\t\t\tpreviousSeven: [],\n\t\t\ttodaysDate: '',\n\t\t\tloading: false,\n\t\t\tdescription: '',\n\t\t\tdescriptionSection: 'hide-description',\n\t\t\tdescriptionButton: 'show-description', \n\t\t\toverRequestedAPIAPI: false,\n\t\t\tliked: false\n\t\t};\n\t}\n\tcomponentDidMount = async () => {\n\t\tthis.setState( { loading: true });\n\t\tconst apod = await fetchAPOD();\n\t\tif (apod.error) {\n\t\t\tthis.setState({ overRequestedAPI: true });\n\t\t} else {\n\t\t\tthis.setState({ apod });\n\t\t\tthis.state.previousSeven.push([]);\n\t\t\tthis.state.previousSeven[0].push(apod);\n\t\t\tthis.setState( { mainLoading: false, todaysDate: apod.date });\n\t\t\tconst currentDate = apod.date;\n\t\t\tconst dateComponents = currentDate.split('-');\n\t\t\tvar year = Number(dateComponents[0]), month = Number(dateComponents[1]), day = Number(dateComponents[2]);\n\t\t\tfor( var i = 1; i < 7; i++) {\n\t\t\t\tif (day === 1){\n\t\t\t\t\tmonth -= 1;\n\t\t\t\t\tif(month === 5 || month === 7 || month === 8 || month === 10 || month === 12) {\n\t\t\t\t\t\tday = 30;\n\t\t\t\t\t} else if (month === 3 ) {\n\t\t\t\t\t\tif (year % 4 === 0) {\n\t\t\t\t\t\t\tday = 29;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tday = 28;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (month === 1) {\n\t\t\t\t\t\tday = 31;\n\t\t\t\t\t\tmonth = 12;\n\t\t\t\t\t\tyear -= 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tday = 30;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tday -= 1;\n\t\t\t\t}\n\t\t\t\tconst newDate = String(year) + \"-\" + String(month) + \"-\" + String(day);\n\t\t\t\tthis.state.previousSeven.push([]);\n\t\t\t\tthis.state.previousSeven[i].push( await fetchAPOD(newDate) );\n\t\t\t}\n\t\t\tif(apod.media_type !== \"video\") {\n\t\t\t\tthis.checkIfLiked(apod);\n\t\t\t}\n\t\t\t\n\t\t\tthis.setState({ loading: false, description: apod.explanation});\n\t\t}\n\t}\n\t\n\tcheckIfLiked = async (photo) => {\n\n\t\tconst urlComponents = photo.hdurl.split('/');\n\t\tconst id = urlComponents[urlComponents.length - 1];\n\t\tconst acc = {\n\t\t\t_id: this.props.location.state.email,\n\t\t\tdata: {\n\t\t\t\t_id: id\n\t\t\t}\n\t\t}\n\t\tlet res = await axios.post(`${BACK_SERVER_URL}/account/favorites/apod/fetch`, acc);\n\t\tif(res.status !== 200) {\n\t\t\tthis.setState({ liked: false });\n\t\t} else {\n\t\t\tthis.setState({ liked: true });\n\t\t}\n\t}\n\thandleClick = (photo) => {\n\t\twindow.scrollTo({top: 240, behavior: 'smooth' });\n\t\tif(photo.date !== this.state.apod.date) {\n\t\t\tthis.setState({ apod: photo });\n\t\t\tif(photo.media_type !== \"video\") {\n\t\t\t\tthis.checkIfLiked( photo );\n\t\t\t}\n\t\t}\n\t} \n\tshowDescription = () => {\n\t\tthis.setState({ descriptionSection: \"show-description\", descriptionButton: \"hide-description\"});\n\t}\n\thideDescription = () => {\n\t\tthis.setState({ descriptionSection: \"hide-description\", descriptionButton: \"show-description\"});\n\t}\n\ttoggleLike = async () => {\n\t\tconst urlComponents = this.state.apod.hdurl.split('/');\n\t\tconst id = urlComponents[urlComponents.length - 1];\n\t\tif(!this.state.liked){\n\t\t\tconst newFav = {\n                _id: this.props.location.state.email,\n                data: {\n\t\t\t\t\t_id: id,\n\t\t\t\t\turl: this.state.apod.hdurl,\n\t\t\t\t\tdate: this.state.apod.date,\n\t\t\t\t\tcomment: \"\",\n\t\t\t\t\tapi: \"apod\"\n\t\t\t\t}\n\t\t\t};\n\t\t\taxios.put(`${BACK_SERVER_URL}/account/favorites/apod/add`, newFav)\n\t\t\t\t.then(response => {\n\t\t\t\t\taddPhotoNotification(id);\n\t\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\t// console.log(err);\n\t\t\t\t});\n\t\t\t\n\t\t}\n\t\telse if(this.state.liked){\n\t\t\taxios.delete('/favorites/apod/delete', {\n\t\t\t\t// for delete, all data must be wrapped in data\n                data: {\n\t\t\t\t\t_id: this.props.location.state.email,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\t_id: id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(response => {\n\t\t\t\tremovePhotoNotification(id);\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\t// console.log(\"didn't delete\");\n\t\t\t});\n\t\t\t\n\t\t}\n\t\tthis.setState({ liked: !this.state.liked });\n\t}\n\n\tlastTap = null;\n\thandleDoubleTap = () => {\n\t\tconst now = Date.now();\n\t\tconst DOUBLE_PRESS_DELAY = 300;\n\t\tif (this.lastTap && (now - this.lastTap) < DOUBLE_PRESS_DELAY) {\n\t\t\tthis.toggleLike();\n\t\t} else {\n\t\t\tthis.lastTap = now;\n\t\t}\n\t}\n\t\n    render() {\n\t\tif(this.state.description !== this.state.apod.explanation) {\n\t\t\tthis.setState({ descriptionSection: \"hide-description\", descriptionButton: \"show-description\", description: this.state.apod.explanation});\n\t\t}\n        return(\n\t\t\t<DocumentTitle title=\"APOD\">\n\t\t\t\t<div id=\"homePage\" onClick={this.props.onClick}> \n\t\t\t\t\t{this.state.overRequestedAPIAPI ? <div>Too many requests to Nasa API</div> :\n\t\t\t\t\t\t<div> \n\t\t\t\t\t\t\t<div className=\"container\">\n\t\t\t\t\t\t\t\t<h1 className=\"page-title d-xs-block d-md-none\"><div>NASA</div><div>Photo of the Day</div></h1>\t\n\t\t\t\t\t\t\t\t<h1 className=\"page-title d-none d-md-block\">Astronomy Picture of the Day</h1>\t\t\n\t\t\t\t\t\t\t\t{this.state.loading ? <Loading/> : \n\t\t\t\t\t\t\t\t\t<div className=\"row\">\n\t\t\t\t\t\t\t\t\t\t<div id=\"main-image\" className=\"col-lg-9 col-md-9 col-sm-12\">\n\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"column-title col-12\"><strong>{this.state.todaysDate === this.state.apod.date ? \"Today\" : formatDisplayDate(this.state.apod.date)}</strong></h3>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"col-12\">\n\t\t\t\t\t\t\t\t\t\t\t\t{this.state.apod.media_type !== \"video\" ?\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img src={this.state.apod.hdurl} onClick={this.handleDoubleTap} alt={this.state.apod.title} /> :\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Iframe src={this.state.apod.url} width=\"100%\"frameBorder=\"0\" allowFullScreen/>\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"col-12 apod-details\">\n\t\t\t\t\t\t\t\t\t\t\t\t{this.state.apod.media_type !== \"video\" ? \n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"icon-holder\" onClick={this.toggleLike}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={this.state.liked ? require('./images/filledHeart.png') : require('./images/emptyHeart.png')}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"heart-icon\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"heart icon\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p> : <p/>\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t<p id=\"apod-date\">{formatDisplayDate(this.state.apod.date)}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p><strong>{this.state.apod.title}</strong></p>\n\t\t\t\t\t\t\t\t\t\t\t\t<p id=\"apod-description-button\" className={`${this.state.descriptionButton} d-xs-block d-md-none`} onClick={this.showDescription}>Click to Read Description...</p>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"d-xs-block d-md-none\" onClick={this.hideDescription}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className={this.state.descriptionSection} >{this.state.description}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"d-none d-md-block\">{this.state.apod.explanation}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t{this.state.apod.copyright ? \n\t\t\t\t\t\t\t\t\t\t\t\t\t<p>Credit: {this.state.apod.copyright}</p> : <p></p>\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id=\"previous-image-column\" className=\"col-lg-3 col-md-3 col-sm-12\">\n\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"column-title col-12\"><strong>Last 7 Days</strong></h3>\n\t\t\t\t\t\t\t\t\t\t\t{this.state.previousSeven.map(last => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img src={last[0].media_type === \"video\" ? thumbnail : last[0].hdurl} className={this.state.apod.date === last[0].date ? \"col-12 previous-image active\" : \"col-12 previous-image\"} loading=\"lazy\" key={last[0].title} onClick={() => {this.handleClick(last[0])}} alt={last[0].title} />\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t</DocumentTitle>\n        );\n    }\n}\n\n// class DescriptionButton extends React.Component {\n// \tconstructor(props){\n// \t\tsuper(props);\n// \t\tthis.state = {\n// \t\t\tdescription: '',\n// \t\t\thideDescription: 'hideDescription'\n// \t\t};\n// \t}\n// \tcomponentDidMount() {\n// \t\tthis.setState({ description: this.props.description });\n// \t\tconsole.log(this.state.description);\n// \t\tconsole.log(this.props.description);\n// \t}\n// \thandleButtonClick = () => {\n// \t\tthis.setState({ hideDescription: \"show-description\"});\n// \t}\n// \trender() {\n// \t\tif(this.state.description !== this.props.description) {\n// \t\t\tthis.setState({ hideDescription: \"hideDescription\", description: this.props.description});\n// \t\t}\n// \t\treturn (\n// \t\t\t<div>\n// \t\t\t\t<p id=\"apod-description-button\" className=\"col-12\" onClick={this.handleButtonClick}>Click to Read Description...</p>\n// \t\t\t\t<p id=\"apod-description\" className={this.state.hideDescription}>{this.state.description}</p>\n// \t\t\t</div>\t\t\t\t\t\n// \t\t);\n// \t}\n\t\n// }"]},"metadata":{},"sourceType":"module"}